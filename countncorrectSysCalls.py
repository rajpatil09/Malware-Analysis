
def correctFeatures():
	
	fl = open('3_SyscallsMetadata.csv','r')
	line = fl.readline()
	fl.close()
	cnt=0
	syslist=""
	fw = open('SyscallsFeaturesMetaData.csv','w')
	
	baseFrequency={}
	words = line.split(",")
	for word in words:
		if((len(word) > 2) and (word.find("(")==-1) and (word.find(" ")==-1) and (word not in baseFrequency)):
			baseFrequency[word] = 0
			cnt+=1
			syslist += word+","
		else:
			print(word, ' already exist')
		
	print('feature-count:', cnt)
	print('baseFrequency-len:',len(baseFrequency))
	fw.write(syslist)
	fw.close()

#correctFeatures()





def countFeatures():
	fl = open('3_SyscallsMetadata.csv','r')
	line = fl.readline()
	fl.close()
	calls = line.split(",")
	baseFrequency={}
	cnt=0
	for call in calls:
		if(call in baseFrequency):
			print(call, ' already exist')
		baseFrequency[call] = 0
		cnt+=1
	print('feature-count:', cnt)
	print('baseFrequency-len:',len(baseFrequency))
	


def lenFeatures():
	fl = open('3_SyscallsMetadata.csv','r')
	line = fl.readline()
	fl.close()
	calls = line.split(",")
	cnt=0

	fw = open('SyscallsFeaturesMetaData.csv','w')	
	syslist=""
	
	for call in calls:
		#if(len(call) > 5):
		#if((call.find('~') == -1) and (call.find('sub') != -1)):
		if((call.find('<') == -1) and (call.find('>') == -1) and (call.find('~') == -1) and (call.find('sub') == -1)):
		#if(call.find('sub') == -1):
			cnt+=1
			syslist += call+","
			#print(call)
		#else:
		#	print(call)
	print('feature-count:', cnt)
	fw.write(syslist)
	fw.close()


lenFeatures()
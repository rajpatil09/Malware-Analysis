
from file_read_backwards import FileReadBackwards

def sortSysCallFeatures(inp,op):
	fop = open(op,"w")
	fip = FileReadBackwards(inp, encoding="utf-8")
	for line in fip:
		#print(line)
		calls = line.split(",")
		print(len(calls))
		for call in calls:
			
			if(call.find(" ")!=-1):
				before=call
				endinx = len(call)-1
				begininx = call.find(" ",0,endinx)
				call = call[begininx+1:endinx]
				print("old:",before, ",new:",call)								
			fop.write(call+"\n")
		#fop.write(line)
		break
	fip.close()
	fop.close()

	'''
	for line in reversed(list(open(inp))):
		print(line.rstrip())
		break
	'''
'''
	f = open(inp,"r")
	cnt = 0
	for line in f:
		cnt +=1
		if(cnt%10000== 0):			
			print("Lines So-far:",cnt,"\n")#,", CONTENT:",line)
	f.close()
	print("Total-Lines:",cnt)
'''

def sortSectionFeatures(inp, op):
	labels = set({})
	fip = open(inp, "r")
	fop = open(op, "w")

	line = fip.readline()
	items = line.split(",")

	for item in items:
		item = item.strip()
		labels.add(item)


	labels = sorted(labels)
	for label in labels:
		print('--',label,'--')
		fop.write(label+",")

	print('Total Items in Set::',len(labels))

	fip.close()
	fop.close()

def getUniqueOpcodes(inp,op):
	uniqueOpcodes = set({})
	f = open(inp,"r")
	for code in f:
		code = code.rstrip('\n')
		code = code.lower()
		code = code.strip()
		if code:
			if(code not in uniqueOpcodes):
				uniqueOpcodes.add(code)
	
	print(len(uniqueOpcodes))
	uniqueOpcodes = sorted(uniqueOpcodes)

	f = open(op,"w")
	for code in uniqueOpcodes:
		f.write(code+"\n")
	f.close()
#sortSectionFeatures("C:/Users/RajPatil09/MSMW/MyApproach/UnsortedSectionsMetadata.csv","C:/Users/RajPatil09/MSMW/MyApproach/SectionsMetadata.csv")
#sortSysCallFeatures("C:/Users/RajPatil09/MSMW/MyApproach/SyscallFeaturesRaw.csv","C:/Users/RajPatil09/MSMW/MyApproach/3_SyscallTemp.csv")

getUniqueOpcodes("C:/Users/RajPatil09/MSMW/MyApproach/nemonics.txt","C:/Users/RajPatil09/MSMW/MyApproach/uniqueNemonics.txt")

